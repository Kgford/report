{% extends "accounts/layout.html" %}
{% load static %}

{% block title %}
    {{ index_type }}
{% endblock %}

{% block body %}
<body">
  
	<main role="main" class="col-md-9 ml-sm-auto col-lg-10 px-md-4">
	<form action = "{% url 'accounts:invoice_item' %}" method="post">
		{% csrf_token %}
		<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
			{% if item == -1 %}
				<h1 class="h2">Create new Trouble Ticket</h1>
			{% else %}
				<h1 class="h2">Modify Trouble Ticket</h1>
			{% endif %}
			<div class="btn-toolbar mb-2 mb-md-0">
				<a style = "color:#CCD1D1" > {{operator}} logged in</a>
			</div>
		</div>
		{% if item == -1 %}
			<input type='hidden' id = '_item_id' name='_item_id' value = "-1" />
		{% else %}
			<input type='hidden' id = 'item_id' name='_item_id' value = "{{item.id}}" />
		{% endif %}
		<div class="row">
			<div class="col-sm-1 col-lg-2 grid-col">
				 <div class="form-group">
					<label>Resource Type<span class="k-required"></span></label>
					<input type='hidden' name='category' data-select='category'/>
					<select id='_res_type' name = "_res_type" value = "{{exp.expense_type}}" class="browser-default custom-select custom-select-lg mb-3" required >
						{% if item == -1 %}
							<option selected>select option</option>
						{% else %}
							<option selected>{{item.resource_type}}</option>
						{% endif %}
						<option data-desc = 'expense_type', value = "Server Error 500">Server Error 500</option>
						<option data-desc = 'expense_type', value = "Server Not Running">Server Not Running</option>
						<option data-desc = 'expense_type', value = "PDF not Moving to Network">PDF not Moving to Network</option>
						<option data-desc = 'expense_type', value = "Item not Closing">Item not Closing</option>
						<option data-desc = 'expense_type', value = "Date Error">Date Error</option>
						<option data-desc = 'expense_type', value = "Date Code Error">Date Code Error</option>
						<option data-desc = 'expense_type', value = "C of C Scaling">C of C Scaling</option>
						<option data-desc = 'expense_type', value = "Label Scaling">Label Scaling</option>
						<option data-desc = 'expense_type', value = "Label Maker Software">Label Maker Software</option>
						<option data-desc = 'expense_type', value = "E2 Failure">E2 Failure</option>
						<option data-desc = 'expense_type', value = "Database Error">Database Error</option>
						<option data-desc = 'expense_type', value = "Printer Error">Printer Error</option>
						<option data-desc = 'expense_type', value = "Printer Low">Printer Low</option>
						<option data-desc = 'expense_type', value = "Network Error">Network Error</option>
						<option data-desc = 'expense_type', value = "Windows Error">Windows Error</option>
					</select>
				</div>	
			</div>	
			<div class="col-sm-1 col-lg-2 grid-col">
				<div class="form-group">
					<label>Service Type<span class="k-required"></span></label>
					<input type='hidden' name='exp_desc' data-select='site'/>
					<select id='_service_type' name = "_service_type" class="browser-default custom-select custom-select-lg mb-3" required>
						{% if item != -1  %}
							<option selected>{{item.service_type}}</option>
						{% else %}
							<option selected>select menu</option>
						{% endif %}	
						<option data-desc = 'expense', value = "ATE Application">ATE Application</option>
						<option data-desc = 'expense', value = "Windows Application">Windows Application</option>
						<option data-desc = 'expense', value = "Web Application">Web Application</option>
						<option data-desc = 'expense', value = "Database Application">Database Application</option>
						<option data-desc = 'expense', value = "Database Application">Network System</option>
						<option data-desc = 'expense', value = "Production">Manual Test Fixture</option>
						<option data-desc = 'expense', value = "Quality">Automated Test Fixture</option>
						<option data-desc = 'expense', value = "Quality">Robot Test Fixture</option>
					</select>
				</div>
			</div>
			<div class="col-sm-1 col-lg-2 grid-col">
				<div class="form-group">
					<!-- contractor-->
					<label>Service Provider<span class="k-required"></span></label>
					<input type='hidden' name='_contractor' data-select='contractor'/>
					<select id='_contractor' name ='_contractor' class="browser-default custom-select custom-select-lg mb-3" required>
						{% if item == -1%}
							<option data-desc = 'contractor', value = "select menu">select menu</option>
						{% else %}
							<option selected>{{contractor}}</option>
						{% endif %}	
						{% for contr in contractor_list%}
							<option data-desc = 'contractor', value = "{{contr}}">{{contr}}</option>
						{% endfor %}
					</select>
				</div>
			</div>
		</div>	
		<div class="row">
			<div class="col-sm-1 col-lg-2 grid-col">
				<div class="form-group">
					<!-- Customer-->
					<label>Customer<span class="k-required"></span></label>
					<input type='hidden' name='_cust' data-select='cust'/>
					<select id='_cust' name ='_cust' class="browser-default custom-select custom-select-lg mb-3" required>
						{% if item == -1%}
							<option data-desc = 'vendor', value = "select menu">select menu</option>
						{% else %}
							<option selected>{{client}}</option>
						{% endif %}	
						{% for cust in client_list%}
							<option data-desc = 'vendor', value = "{{cust}}">{{cust}}</option>
						{% endfor %}
					</select>
				</div>
			</div>
			<div class="col-sm-1 col-lg-2 grid-col">
				<div class="form-group">
					<!-- Customer-->
					<label>Charge Code<span class="k-required"></span></label>
					<input type='hidden' name='_charge' data-select='cust'/>
					<select id='_charge' name ='_charge' class="browser-default custom-select custom-select-lg mb-3" required>
						{% if item == -1%}
							<option data-desc = 'charge', value = "select menu">select menu</option>
						{% else %}
							<option selected>{{charge}}</option>
						{% endif %}	
						{% for charg in charge_list%}
							<option data-desc = 'charge', value = "{{charg}}">{{charg}}</option>
						{% endfor %}
					</select>
				</div>
			</div>
			<div class="col-sm-1 col-lg-2 grid-col">
				<div class="form-group">
					{% if item != -1 %}
						<label for="_quantity">Invoice ID</label>
						<input id = "_invoice_id"  name = "_invoice_id" input class="form-control" value = "{{item.invoice_id}}"  required>
					{% endif %}
				</div>	
			</div>
		</div>
		<div class="row">
			<div class="col-sm-1 col-lg-4 grid-col">
				<div class="form-group">
					<label for="_item_desc">Product or Service</label>
					{% if item == -1 %}
						<input id = "_item_desc" name = "_item_desc" input class="form-control" placeholder="Enter Item description"  required >
					{% else %}
						<input id = "_item_desc" name = "_item_desc" input class="form-control" value = "{{item.item_desc}}"  required >
					{% endif %}
				</div>
			</div>
			<div class="col-sm-1 col-lg-2 grid-col">
				<div class="form-group">
					<label for="_quantity">Item Date</label>
					{% if item == -1 %}
						<input type = "date" id = "_item_date"  name = "_item_date" input class="form-control" required>
					{% else %}
						<input  type = "date" id = "_item_date"  name = "_item_date" input class="form-control" value = {{item.item_date}} required>
					{% endif %}
				</div>	
			</div>
		</div>
		<div class="row">
			<div class="col-sm-1 col-lg-1 grid-col">
				<div class="form-group">
					<label>Cost Type<span class="k-required"></span></label>
					<input type='hidden' name='exp_desc' data-select='site'/>
					<select id='_item_cost_type' name = "_item_cost_type" class="browser-default custom-select custom-select-lg mb-3" required>
						{% if item != -1  %}
							<option selected>{{item.cost_type}}</option>
						{% else %}
							<option selected>select menu</option>
						{% endif %}	
						<option data-desc = 'expense', value = "Per Hour">Per Hour</option>
						<option data-desc = 'expense', value = "Quantity">Quantity</option>
						<option data-desc = 'expense', value = "Size mm">Size mm</option>
						<option data-desc = 'expense', value = "Size cm">Size cm</option>
						<option data-desc = 'expense', value = "Size meter">Size meter</option>
						<option data-desc = 'expense', value = "Size inch">Size inch</option>
						<option data-desc = 'expense', value = "Size Foot">Size Foot</option>
						<option data-desc = 'expense', value = "Length mm">Length mm</option>
						<option data-desc = 'expense', value = "Length cm">Length cm</option>
						<option data-desc = 'expense', value = "Length meter">Length meter</option>
						<option data-desc = 'expense', value = "Length inch">Length inch</option>
						<option data-desc = 'expense', value = "Length Foot">Length Foot</option>
					</select>
				</div>
			</div>
			<div class="col-sm-1 col-lg-1 grid-col">
				<div class="form-group">
					<label for="_quantity">Quantity</label>
					{% if item == -1 %}
						<input id = "_quantity"  name = "_quantity" input class="form-control"  placeholder="Quantity" required>
					{% else %}
						<input id = "_quantity"  name = "_quantity" value = "{{item.quantity}}" input class="form-control" required>
					{% endif %}
				</div>	
			</div>
			<div class="col-sm-1 col-lg-1 grid-col">
				<div class="form-group">
					<label for="_item_cost">Rate</label>
					{% if item == -1 %}
						<input id = "_item_cost"  name = "_item_cost" input class="form-control"  placeholder="Enter cost" required>
					{% else %}
						<input id = "_item_cost"  name = "_item_cost" value = "{{item.rate}}" input class="form-control" required>
					{% endif %}
				</div>	
			</div>
			<div class="col-sm-1 col-lg-1 grid-col">
				<div class="form-group">
					<label for="_total_cost">Total Cost</label>
					{% if item == -1 %}
						<input id = "_total_cost" name = "_total_cost" input class="form-control" placeholder="Total cost"  required>
					{% else %}
						<input id = "_total_cost" name = "_total_cost" input class="form-control" value = "{{item.total}}" required>
					{% endif %}
				</div>
			</div>
			{% if item == -1 %}
					<div class="col-sm-1 col-lg-1 grid-col">
						<div class="form-group">
							<label  for="_quantity">Save</label>
							<button type="submit" id = "_save" name = "_save"  class="btn btn-success">Save Item</button>
						</div>
					</div>
				{% else %}
					<div class="col-sm-1 col-lg-1 grid-col">
						<div class="form-group">
							<button type="submit" id = "_update" name = "_update"  class="btn btn-primary">Update</button>
							<button type="submit" id = "_delete" name = "_delete"  class="btn btn-danger">Delete&nbsp;</button>
						</div>
					</div>
				{% endif %}
			</div>
		<div class="row">
		</div>
			<div class="col-sm-1 col-lg-2 grid-col">
				<div class="form-group">
					<div class="form-check">
						{% if active == 'on' %}
							<input type="checkbox" class="form-check-input" id="_active" name="_active" checked = "checked" onclick="check();"/>
							<label class="form-check-label" for="_active">&nbsp;&nbsp;&nbsp;&nbsp;Active</label>
						{% elif active == 'off' %}
							<input type="checkbox" class="form-check-input" id="_active" name="_active" onclick="check();"/>
							<label class="form-check-label" for="_active">&nbsp;&nbsp;&nbsp;&nbsp;Active?</label>
						{% else %}
							<input type="checkbox" class="form-check-input" id="_active" name="_active" checked = "checked" onclick="check();"/>
							<label class="form-check-label" for="_active">&nbsp;&nbsp;&nbsp;&nbsp;Active</label>
						{% endif %}
					</div>
			
		
		
	</form>
	</div>
		</div>	
		<h2 class="text-center">Items List</h2>
		<div class="table-responsive" Method = "POST">
			 <table id = "table_id" class="table table-striped table-sm">
			    <thead>
					<tr>
						<th>Ticket ID</th>
						<th>Pack List ID</th>
						<th>Trouble Date</th>
						<th>Job Number</th>
						<th>Trouble Type</th>
						<th>Trouble Status</th>
						<th>Reported by</th>
					</tr>
			    </thead>
				<tbody>
					{% for ticket in open_tickets %}
						<tr
							<td><a class="nav-link" href="{% url 'accounts:invoice_item' %}?item_id={{item1.id}}&charge_id={{item1.charge_id}}&client_id={{item1.client_id}}">{{item1.id}}</td>
							<td><a class="nav-link" href="{% url 'accounts:invoice_item' %}?item_id={{item1.id}}&charge_id={{item1.charge_id}}&client_id={{item1.client_id}}">{{item1.packing_list_detail_id}}</td>
							<td><a class="nav-link" href="{% url 'accounts:invoice_item' %}?item_id={{item1.id}}&charge_id={{item1.charge_id}}&client_id={{item1.client_id}}">{{item1.job_number}</td>
							<td><a class="nav-link" href="{% url 'accounts:invoice_item' %}?item_id={{item1.id}}&charge_id={{item1.charge_id}}&client_id={{item1.client_id}}">{{item1.trouble_type}}</td>
							<td><a class="nav-link" href="{% url 'accounts:invoice_item' %}?item_id={{item1.id}}&charge_id={{item1.charge_id}}&client_id={{item1.client_id}}">{{item1.trouble_Status}}</td>
							<td><a class="nav-link" href="{% url 'accounts:invoice_item' %}?item_id={{item1.id}}&charge_id={{item1.charge_id}}&client_id={{item1.client_id}}">{{item1.reported_by}}</td>
						</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
    </main>
  </div>
</div>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script>
	$(document).ready(function() {
		// Get value on button click and show alert
		$("#_quantity").keyup(calc);
		$("#_item_cost").keyup(calc);
		function calc() {
		  $('#_total_cost').val(
			parseInt($('#_quantity').val(), 10) * parseFloat($('#_item_cost').val(), 10)
		);
	}
	});
</script>
		
<script src="https://cdnjs.cloudflare.com/ajax/libs/feather-icons/4.9.0/feather.min.js"></script> 
<script>'undefined'=== typeof _trfq || (window._trfq = []);'undefined'=== typeof _trfd && (window._trfd=[]),_trfd.push({'tccl.baseHost':'secureserver.net'}),_trfd.push({'ap':'cpsh'},{'server':'p3plcpnl0769'}) // Monitoring performance to make your website faster. If you want to opt-out, please contact web hosting support.</script>

</body>
{% endblock %}

</html>
